"use strict";var WPFormsGeolocationGooglePlacesAPI=window.WPFormsGeolocationGooglePlacesAPI||function(a,t){var n,s=[],l={init:function(){l.getFields(),s.length&&(l.initGeocoder(),s.forEach(function(e){l.initMap(e),l.initAutocomplete(e)}),l.detectGeolocation(),l.bindFormEvents())},bindFormEvents:function(){const i=[];a.querySelectorAll(".wpforms-form").forEach(function(o){if(o.querySelector("[data-autocomplete]")){const n=o.getAttribute("data-formid");new MutationObserver(function(e){e.forEach(function(e){if(e.target.classList.contains("pac-container")&&"attributes"===e.type&&"style"===e.attributeName){const t=o.querySelector(".wpforms-submit");"none"!==e.target.style.display?(t.disabled=!0,delete i[n]):i[n]=setTimeout(function(){t.disabled=!1},300)}})}).observe(a.querySelector("body"),{attributes:!0,subtree:!0})}})},showDebugMessage:function(e){t.location.hash&&"#wpformsdebug"===t.location.hash&&console.log(e)},closest:function(e,t){for(var o=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e&&!o.call(e,t);)e=e.parentElement;return e},getFields:function(){Array.prototype.slice.call(a.querySelectorAll('.wpforms-form .wpforms-field input[type="text"][data-autocomplete="1"]')).forEach(function(e){var t,o=l.closest(e,".wpforms-field"),n=e.hasAttribute("data-display-map")?o.querySelector(".wpforms-geolocation-map"):null,i=o.classList[1]?o.classList[1].replace("wpforms-field-",""):"text",a={};"address"===i&&(t=o.querySelector(".wpforms-field-address-country"),a={locality:{el:o.querySelector(".wpforms-field-address-city"),type:"long_name"},postal_town:{el:o.querySelector(".wpforms-field-address-city"),type:"long_name"},political:{el:o.querySelector(".wpforms-field-address-state"),type:t?"long_name":"short_name"},administrative_area_level_1:{el:o.querySelector(".wpforms-field-address-state"),type:t?"long_name":"short_name"},postal_code:{el:o.querySelector(".wpforms-field-address-postal"),type:"long_name"},country:{el:t,type:"short_name"}}),s.push({searchField:e,mapField:n,type:i,additionalFields:a,settings:l.getFieldSettings(e)})})},getFieldSettings:function(e){return{autocompleteSettings:l.getFieldAutocompleteSettings(e),mapSettings:l.getFieldMapSettings(e),markerSettings:l.getFieldMarkerSettings(e)}},getFieldAutocompleteSettings:function(e){e=e.getAttribute("id").replaceAll("-","_");return Object.assign({types:["geocode"]},wpforms_geolocation_settings.autocompleteSettings.common||{},wpforms_geolocation_settings.autocompleteSettings[e]||{})},getFieldMapSettings:function(e){e=e.getAttribute("id").replaceAll("-","_");return Object.assign({zoom:wpforms_geolocation_settings.zoom||9,center:wpforms_geolocation_settings.default_location||{}},wpforms_geolocation_settings.mapSettings.common||{},wpforms_geolocation_settings.mapSettings[e]||{})},getFieldMarkerSettings:function(e){e=e.getAttribute("id").replaceAll("-","_");return Object.assign({draggable:!0},wpforms_geolocation_settings.markerSettings.common||{},wpforms_geolocation_settings.markerSettings[e]||{})},initMap:function(e){e.mapField&&(e.map=new google.maps.Map(e.mapField,e.settings.mapSettings),e.marker=new google.maps.Marker(Object.assign({map:e.map,position:e.settings.mapSettings.center||{}},e.settings.markerSettings)),e.marker.addListener("dragend",l.markerDragend))},initGeocoder:function(){n=new google.maps.Geocoder},markerDragend:function(t){var o=l.findFieldPlaceByMarker(this);o&&l.detectPlaceByCoordinates(t.latLng,function(e){l.updateFields(o,e),o.map.setCenter(t.latLng)})},detectByCoordinates:function(o,e){console.warn("The WPFormsGeolocationGooglePlacesAPI.detectByCoordinates() is deprecated since version 2.3.0! Use the WPFormsGeolocationGooglePlacesAPI.detectPlaceByCoordinates() instead."),n&&n.geocode({location:e},function(e,t){"OK"!==t?(l.showDebugMessage("Geocode was wrong"),l.showDebugMessage(e)):e[0]&&l.updateFields(o,e[0])})},detectPlaceByCoordinates:function(e,o){n&&n.geocode({location:e},function(e,t){"OK"!==t?(l.showDebugMessage("Geocode was wrong"),l.showDebugMessage(e)):e[0]&&o(e[0])})},updateMap:function(e,t){e.map&&(e.marker.setPosition(t),e.map.setCenter(t))},findFieldPlaceByMarker:function(t){var o=null;return s.forEach(function(e){e.marker===t&&(o=e)}),o},findFieldPlaceByAutocomplete:function(t){var o=null;return s.forEach(function(e){e.autocomplete===t&&(o=e)}),o},findFieldPlaceByCountry:function(t){var o=null;return s.forEach(function(e){e.additionalFields&&e.additionalFields.country&&e.additionalFields.country.el===t&&(o=e)}),o},findFieldPlaceByPolitical:function(t){var o=null;return s.forEach(function(e){e.additionalFields&&e.additionalFields.political&&e.additionalFields.political.el===t&&(o=e)}),o},initAutocomplete:function(e){e.autocomplete=new google.maps.places.Autocomplete(e.searchField,e.settings.autocompleteSettings),e.autocomplete.addListener("place_changed",l.updateFieldPlace),"address"===e.type&&l.initAutocompleteAddress(e),e.settings.autocompleteSettings.strict&&(e.autocomplete.setComponentRestrictions({country:e.settings.autocompleteSettings.strict}),l.showDebugMessage("The #"+e.searchField.getAttribute("id")+" autocomplete field restrict to the "+e.settings.autocompleteSettings.strict.join(", ")+" counties"))},initAutocompleteAddress:function(e){l.disableBrowserAutocomplete(e.searchField),e.additionalFields.country.el&&e.additionalFields.country.el.addEventListener("change",l.updateCountry),e.additionalFields.political.el&&e.additionalFields.political.el.addEventListener("change",l.updateArea)},disableBrowserAutocomplete:function(e){var t;-1!==navigator.userAgent.indexOf("Chrome")&&(t=new MutationObserver(function(){t.disconnect(),e.setAttribute("autocomplete","chrome-off")})).observe(e,{attributes:!0,attributeFilter:["autocomplete"]})},updateFieldPlace:function(){var e,t=l.findFieldPlaceByAutocomplete(this);t&&t.autocomplete&&(e=t.autocomplete.getPlace()).geometry&&e.geometry.location&&(l.updateMap(t,e.geometry.location),l.updateFields(t,e))},updateFields:function(e,t){Object.prototype.hasOwnProperty.call(t,"formatted_address")&&("text"===e.type?l.updateTextField(e,t):"address"===e.type&&l.updateAddressFields(e,t),l.triggerEvent(e.searchField,"change"),l.showDebugMessage("Fields was updated"),l.showDebugMessage(e),l.showDebugMessage(t))},updateTextField:function(e,t){e.searchField.value=t.formatted_address},triggerEvent:function(e,t){var o=a.createEvent("HTMLEvents");o.initEvent(t,!0,!0),e.dispatchEvent(o)},updateAddressFields:function(e,t){var o="",n="";l.clearAdditionalFields(e);for(var i=0;i<t.address_components.length;i++){var a=t.address_components[i].types[0];"route"===a?o=t.address_components[i].short_name:"street_number"===a?n=t.address_components[i].short_name:e.additionalFields[a]&&e.additionalFields[a].el&&l.updateAddressField(e.additionalFields[a].el,t.address_components[i][e.additionalFields[a].type])}e.searchField.value=l.formatAddressField(t,n,o)},updateAddressField:function(e,t){l.isConversationalSelect(e)?l.updateConversationalSelect(e,t):e.value=t},isConversationalSelect:function(e){return"SELECT"===e.tagName&&Boolean(e.closest(".wpforms-conversational-select"))},updateConversationalSelect:function(e,t){var o=e.closest(".wpforms-conversational-select"),n=e.querySelector('option[value="'+t+'"]'),o=o.querySelector(".wpforms-conversational-form-dropdown-input input");e.value=t,n&&o&&(o.value=n.innerText)},clearAdditionalFields:function(e){Object.values(e.additionalFields).forEach(function(e){e.el&&(e.el.value="")})},formatAddressField:function(e,t,o){return(0===e.formatted_address.indexOf(t)?t+" "+o:o+", "+t).trim().replace(/,$|^,/g,"")},updateCountry:function(){var e=l.findFieldPlaceByCountry(this),t=this.value.toString().toLocaleLowerCase();e&&e.autocomplete&&(e.autocomplete.setComponentRestrictions({country:[t]}),l.showDebugMessage("Autocomplete field restrict to the "+t+" country"))},updateArea:function(){var e,t=l.findFieldPlaceByPolitical(this),o=this.value.toString().toUpperCase();t&&t.autocomplete&&(l.showDebugMessage("Autocomplete field try to find the "+o+" state"),(e=l.findStateCoordinates(t,o))?(t.autocomplete.setBounds(new google.maps.LatLngBounds(e)),l.showDebugMessage("Autocomplete field restrict to the "+o+" state")):l.showDebugMessage("Autocomplete field doesn't restrict to the "+o+" state"))},findStateCoordinates:function(e,t){var o;if(e.settings.autocompleteSettings.strict)return e.settings.autocompleteSettings.strict.forEach(function(e){if(wpforms_geolocation_settings.states[e]&&wpforms_geolocation_settings.states[e][t])return!(o={lat:wpforms_geolocation_settings.states[e][t].lat,lng:wpforms_geolocation_settings.states[e][t].lng})}),o},detectGeolocation:function(){var o;wpforms_geolocation_settings.current_location&&navigator.geolocation&&s&&(o={},navigator.geolocation.getCurrentPosition(function(e){o={lat:e.coords.latitude,lng:e.coords.longitude},l.detectPlaceByCoordinates(o,function(t){s.forEach(function(e){e.searchField.closest(".wpforms-field").classList.contains("wpforms-conditional-hide")||(l.updateMap(e,o),l.updateFields(e,t))})})}))}};return l}(document,window);function WPFormsGeolocationInitGooglePlacesAPI(){window.removeEventListener("load",WPFormsGeolocationGooglePlacesAPI.init),WPFormsGeolocationGooglePlacesAPI.init()}window.addEventListener("load",WPFormsGeolocationGooglePlacesAPI.init);